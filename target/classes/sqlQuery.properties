
#Erms.AgreementCodeDetails=select agreementmst.AGREEMENT_CODE,Agentmst.AGENT_NAME,agreementmst.AGREEMENT_ID,Agentmst.AGENT_ID ,Agentmst.CREATE_DATE, Agentmst.MOBILE, Agentmst.EMAIL, Agentmst.LICENSE_EXP_DATE,agreementmst.STATUS from GENERALSYSTEM.T_SBI_AGT_AGENT@LINK_EBAODR Agentmst inner join GENERALSYSTEM.T_AGT_AGREEMENT@LINK_EBAODR agreementmst on  Agentmst.AGENT_ID=agreementmst.AGENT_ID where agreementmst.AGREEMENT_CODE =:agent_code
Erms.AgreementCodeDetails=select AGREEMENT_CODE,CUSTOMER_NAME,SYSTEM_ISSUE_DATE,MOBILE_NUMBER,EMAIL_ID,POLICY_END_DATE,AGREEMENT_STATUS from  DWH_LAND.INTERMEDIARIES_DATA@link_sbigans where AGREEMENT_CODE =:agent_code
#Erms.DwbiMotorRenewalPolicyReport=select p.policy_no  as Policy_NO,p.issue_date  as POLICY_ISSUE_DATE,p.eff_date  as POLICY_START_DATE,p.exp_date   as POLICY_END_DATE,I.INDI_PARTY_NAME   AS CUSTOMER_NAME,pg.PRODUCT_NAME,pg.PRODUCT_CODE,p.APP AS Premium_Amount,I.ID_NUMBER as PAN_CARD,P.QUOTE_NO,P.QUOTE_NO AS PROPOSAL_NO,p.AGREEMENT_ID from generalsystem.t_policy_general@link_ebaodr p,generalsystem.t_policy_gen_cust@link_ebaodr c,generalsystem.T_GEN_POLICY_INFO@link_ebaodr gpi, generalsystem.T_SBI_FINANCE_LIST@link_ebaodr f,generalsystem.t_product_general@link_ebaodr pg, generalsystem.t_pty_indi@link_ebaodr I where  p.policy_id = c.policy_id and c.policy_id = gpi.policy_id and gpi.policy_id = f.policy_id and p.product_id  = pg.product_id and c.party_id  = I.pty_id and p.agreement_id=(select AGREEMENT_ID from GENERALSYSTEM.T_AGT_AGREEMENT@LINK_EBAODR where AGREEMENT_CODE =:agent_code) and TRUNC(p.issue_date) between :startDate and :endDate and PRODUCT_NAME IN (:product)
#Erms.DwbiMotorRenewalPolicyReport=select p.policy_no  as Policy_NO,p.issue_date  as POLICY_ISSUE_DATE,p.eff_date  as POLICY_START_DATE,p.exp_date as POLICY_END_DATE,I.INDI_PARTY_NAME AS CUSTOMER_NAME,pg.PRODUCT_NAME,pg.PRODUCT_CODE,p.APP AS Premium_Amount,I.ID_NUMBER as PAN_CARD,P.QUOTE_NO,o.hand_phone,o.email,P.QUOTE_NO AS PROPOSAL_NO,p.AGREEMENT_ID from generalsystem.t_policy_general@link_ebaodr p, generalsystem.t_policy_gen_cust@link_ebaodr c,  generalsystem.T_GEN_POLICY_INFO@link_ebaodr gpi, generalsystem.T_SBI_FINANCE_LIST@link_ebaodr f,  generalsystem.t_product_general@link_ebaodr pg,  generalsystem.t_pty_indi@link_ebaodr I,   generalsystem.t_pty_other_contact@link_ebaodr o where  p.policy_id      = c.policy_id and    c.policy_id      = gpi.policy_id and    gpi.policy_id = f.policy_id and  p.product_id  = pg.product_id and c.party_id = I.pty_id and   c.party_id = o.pty_id and p.agreement_id=(select AGREEMENT_ID from GENERALSYSTEM.T_AGT_AGREEMENT@LINK_EBAODR where AGREEMENT_CODE =:agent_code) and TRUNC(p.issue_date) between :startDate and :endDate and PRODUCT_NAME IN (:product)
Erms.DwbiMotorRenewalPolicyReport=select  policy_no,POLICY_ISSUE_DATE,POLICY_START_DATE,POLICY_END_DATE,CUSTOMER_NAME,PRODUCT_NAME,PRODUCT_CODE,PREMIUM_AMOUNT,MDM_PARTY_ID,QUOTE_NO,MOBILE_NUMBER,EMAIL_ID,INTERMEDIARY_CODE,INTERMEDIARY_NAME,SBIG_BRANCH_NAME_DIRECT from DWH_LAND.INTERMEDIARIES_DATA@link_sbigans where AGREEMENT_CODE=:agent_code and TRUNC(POLICY_ISSUE_DATE) between :startDate and :endDate 

#Erms.DwbiHealthRenewalPolicyReport=select EXPIRING_POLICY_NO as POLICY_NO,INSURED_NAME,CURR_PHONE_NO,PRIM_EMAIL_ADDR as PRIMARY_EMAIL_ID,EXPIRING_POLICY_EXPIRY_DATE as POLICY_EXPIRY_DATE,EXPIRING_POLICY_EXPIRY_MONTH as POLICY_EXPIRY_MONTH,PRODUCT_NAME,INTERMEDEIARY_CODE,INTERMEDIARY_NAME,TOTAL_RENEWAL_PREMIUM,RENEWAL_QUOTE_STATUS,RENEWAL_NOTICE_STATUS,AUTO_RENEWAL_FLAG,SBIG_REGION as REGION,LOB,RENEWAL_QUOTE_LATEST_FLAG as RENEWAL_FLAG , SECONDARY_SALES_MANAGER_CODE as SECONDRY_SM_CODE,renewal_quote_no  FROM DE_HEALTH_RENEWAL_RPT_FY_2023_24 where EXPIRING_POLICY_EXPIRY_DATE BETWEEN :startDate and :endDate and INTERMEDEIARY_CODE=:INTERMEDIARY_CODE  and UPPER(EXPIRING_POLICY_EXPIRY_MONTH) =:formattedMonth and CHANNEL_NAME IN (:channel) and PRODUCT_NAME IN (:product) and SECONDARY_SALES_MANAGER_CODE in(select :user from dual union SELECT EMP_Code FROM dwh_edw_bak.SSM_sales_hierarchy @LINK_SBIGANS  START WITH REPORTS_TO_EMP_ID=:user CONNECT BY NOCYCLE PRIOR EMP_Code=REPORTS_TO_EMP_ID) AND RENEWAL_POLICY_NO IS NOT NULL
#Erms.DwbiSmeRenewalPolicyReport=select EXPIRING_POLICY_NO as POLICY_NO,INSURED_NAME,CURR_PHONE_NO,PRIM_EMAIL_ADDR as PRIMARY_EMAIL_ID,EXPIRING_POLICY_EXPIRY_DATE as POLICY_EXPIRY_DATE,EXPIRING_POLICY_EXPIRY_MONTH as POLICY_EXPIRY_MONTH,PRODUCT_NAME,INTERMEDEIARY_CODE,INTERMEDIARY_NAME,RENEWAL_QUOTE_TOTAL_PREMIUM AS TOTAL_RENEWAL_PREMIUM,RENEWAL_QUOTE_STATUS,RENEWAL_NOTICE_STATUS,AUTO_RENEWAL_FLAG,SBIG_REGION as REGION,LOB,RENEWAL_QUOTE_LATEST_FLAG as RENEWAL_FLAG , SECONDARY_SALES_MANAGER_CODE as SECONDRY_SM_CODE,renewal_quote_no FROM DE_INDIGENEOUS_RENEWAL_RPT_FY_2023_24 where EXPIRING_POLICY_EXPIRY_DATE BETWEEN :startDate and :endDate  and INTERMEDEIARY_CODE=:INTERMEDIARY_CODE and UPPER(EXPIRING_POLICY_EXPIRY_MONTH) =:formattedMonth and PRODUCT_NAME=:product and SECONDARY_SALES_MANAGER_CODE in(select :user from dual union SELECT EMP_Code FROM dwh_edw_bak.SSM_sales_hierarchy @LINK_SBIGANS  START WITH REPORTS_TO_EMP_ID=:user CONNECT BY NOCYCLE PRIOR EMP_Code=REPORTS_TO_EMP_ID) AND RENEWAL_POLICY_ID IS NOT NULL
#Erms.PolicyDeatils=select p.policy_no  as Policy_NO,p.issue_date  as POLICY_ISSUE_DATE,p.eff_date  as POLICY_START_DATE,p.exp_date   as POLICY_END_DATE,I.INDI_PARTY_NAME   AS CUSTOMER_NAME,pg.PRODUCT_NAME,pg.PRODUCT_CODE,p.APP AS Premium_Amount,I.ID_NUMBER as PAN_CARD,P.QUOTE_NO,P.QUOTE_NO AS PROPOSAL_NO,p.AGREEMENT_ID from generalsystem.t_policy_general@link_ebaodr p,generalsystem.t_policy_gen_cust@link_ebaodr c,generalsystem.T_GEN_POLICY_INFO@link_ebaodr gpi, generalsystem.T_SBI_FINANCE_LIST@link_ebaodr f,generalsystem.t_product_general@link_ebaodr pg, generalsystem.t_pty_indi@link_ebaodr I where  p.policy_id = c.policy_id and c.policy_id = gpi.policy_id and gpi.policy_id = f.policy_id and p.product_id  = pg.product_id and c.party_id  = I.pty_id and p.agreement_id=(select AGREEMENT_ID from GENERALSYSTEM.T_AGT_AGREEMENT@LINK_EBAODR where AGREEMENT_CODE =:agent_code)
Erms.PolicyDeatils=select  policy_no,POLICY_ISSUE_DATE,POLICY_START_DATE,POLICY_END_DATE,CUSTOMER_NAME,PRODUCT_NAME,PRODUCT_CODE,PREMIUM_AMOUNT,MDM_PARTY_ID,QUOTE_NO,MOBILE_NUMBER,EMAIL_ID,INTERMEDIARY_CODE from DWH_LAND.INTERMEDIARIES_DATA@link_sbigans where AGREEMENT_CODE=:agent_code 

Erms.dashPolicyCountMonthReport=select PRODUCTNAME,RENEWALCOUNT,RENEWED,RENWEALDUE,EXPIRED from EMS_RENEWAL_DASHBOARD where INTERMEDIATECODE=:INTERMEDIATECODE AND MONTH=:POLICY_EXPIRY_MONTH
Erms.BussinessSummaryReport=select PRODUCTNAME,TOTALNUMBERPOLICY,documentpending,MYQUOTE,PAYMENTPENDING from BUSSINESS_SUMMARY_REPORT where INTERMEDIATECODE=:INTERMEDIATECODE AND MONTH=:POLICY_EXPIRY_MONTH
Erms.BirthdayWise=select CUSTOMERNAME,MOBILENUMBER,email,dob from EMS_calander_wise where INTERMEDIATECODE=:INTERMEDIATECODE AND DOB=:POLICY_EXPIRY_MONTH
#DwbiMotorRenewalPolicyReport=select POLICY_NO,INSURED_NAME,CURRENT_PHONE_NO,PRIMARY_EMAIL_ID ,POLICY_EXPIRY_DATE,POLICY_EXPIRY_MONTH,PRODUCT_NAME, INTERMEDIARY_CODE,INTERMEDIARY_NAME,TOTAL_RENEWAL_PREMIUM,RENEWAL_QUOTE_STATUS,RENEWAL_NOTICE_STATUS,AUTO_RENEWAL_FLAG,REGION,LOB,RENEWAL_FLAG,SECONDRY_SM_CODE,renewal_quote_number,loan_account_no,sbig_branch_name, asm_id as sbi_account_no,REGISTRATION_NUMBER,YEAR_OF_MANUFACTURING,CHASSIS_NUMBER,MAKE,MODEL,NCB_AMOUNT FROM DE_MOTOR_RENEWAL_RPT_FY_2023_24 where POLICY_EXPIRY_DATE BETWEEN :startDate and :endDate  and POLICY_EXPIRY_MONTH =:formattedMonth and PRODUCT_NAME IN (:product) and NEW_CHANNEL_NAME IN (:channel) and INTERMEDIARY_CODE=:INTERMEDIARY_CODE and SECONDRY_SM_CODE IN(select :user from dual union SELECT EMPLOYEE_ID FROM SBIG_EMPLYOEE_MASTER START WITH RM_ID=:user CONNECT BY NOCYCLE PRIOR EMPLOYEE_ID=RM_ID and EMPLOYMENT_STATUS='Active')  AND policy_id != '-1' 
#mis.Motordwbiquery=select POLICY_NO,INSURED_NAME,CURRENT_PHONE_NO,PRIMARY_EMAIL_ID ,POLICY_EXPIRY_DATE,POLICY_EXPIRY_MONTH,PRODUCT_NAME, INTERMEDIARY_CODE,INTERMEDIARY_NAME,TOTAL_RENEWAL_PREMIUM,RENEWAL_QUOTE_STATUS,RENEWAL_NOTICE_STATUS,AUTO_RENEWAL_FLAG,REGION,LOB,RENEWAL_FLAG,SECONDRY_SM_CODE,renewal_quote_number,loan_account_no,sbig_branch_name, asm_id as sbi_account_no,REGISTRATION_NUMBER,YEAR_OF_MANUFACTURING,CHASSIS_NUMBER,MAKE,MODEL,NCB_AMOUNT FROM DE_MOTOR_RENEWAL_RPT_FY_2023_24 where POLICY_EXPIRY_DATE BETWEEN :startDate and :endDate  and POLICY_EXPIRY_MONTH =:formattedMonth   and INTERMEDIARY_CODE=:user   AND policy_id != '-1' 
#
##DwbiHealthRenewalPolicyReport=select EXPIRING_POLICY_NO as POLICY_NO,INSURED_NAME,CURR_PHONE_NO,PRIM_EMAIL_ADDR as PRIMARY_EMAIL_ID,EXPIRING_POLICY_EXPIRY_DATE as POLICY_EXPIRY_DATE,EXPIRING_POLICY_EXPIRY_MONTH as POLICY_EXPIRY_MONTH,PRODUCT_NAME,INTERMEDEIARY_CODE,INTERMEDIARY_NAME,TOTAL_RENEWAL_PREMIUM,RENEWAL_QUOTE_STATUS,RENEWAL_NOTICE_STATUS,AUTO_RENEWAL_FLAG,SBIG_REGION as REGION,LOB,renewal_policy_status as RENEWAL_FLAG ,SECONDARY_SALES_MANAGER_CODE as SECONDRY_SM_CODE,renewal_quote_no,loan_account_number,sbig_branch_name,sbi_account_no  FROM DE_HEALTH_RENEWAL_RPT_FY_2023_24 where EXPIRING_POLICY_EXPIRY_DATE BETWEEN :startDate and :endDate and INTERMEDEIARY_CODE=:INTERMEDIARY_CODE  and UPPER(EXPIRING_POLICY_EXPIRY_MONTH) =:formattedMonth and CHANNEL_NAME IN (:channel) and PRODUCT_NAME IN (:product) and SECONDARY_SALES_MANAGER_CODE IN(select :user from dual union SELECT EMPLOYEE_ID FROM SBIG_EMPLYOEE_MASTER START WITH RM_ID=:user CONNECT BY NOCYCLE PRIOR EMPLOYEE_ID=RM_ID and EMPLOYMENT_STATUS='Active') AND  renewal_quote_latest_flag = 'Y'
#mis.Healthdwbiquery=select EXPIRING_POLICY_NO as POLICY_NO,INSURED_NAME,CURR_PHONE_NO,PRIM_EMAIL_ADDR as PRIMARY_EMAIL_ID,EXPIRING_POLICY_EXPIRY_DATE as POLICY_EXPIRY_DATE,EXPIRING_POLICY_EXPIRY_MONTH as POLICY_EXPIRY_MONTH,PRODUCT_NAME,INTERMEDEIARY_CODE,INTERMEDIARY_NAME,TOTAL_RENEWAL_PREMIUM,RENEWAL_QUOTE_STATUS,RENEWAL_NOTICE_STATUS,AUTO_RENEWAL_FLAG,SBIG_REGION as REGION,LOB,renewal_policy_status as RENEWAL_FLAG ,SECONDARY_SALES_MANAGER_CODE as SECONDRY_SM_CODE,renewal_quote_no,loan_account_number,sbig_branch_name,sbi_account_no  FROM DE_HEALTH_RENEWAL_RPT_FY_2023_24 where EXPIRING_POLICY_EXPIRY_DATE BETWEEN :startDate and :endDate and INTERMEDEIARY_CODE=:user  and UPPER(EXPIRING_POLICY_EXPIRY_MONTH) =:formattedMonth    AND  renewal_quote_latest_flag = 'Y'
#
#mis.SmeproductType=select EXPIRING_POLICY_NO as POLICY_NO,INSURED_NAME,CURR_PHONE_NO,PRIM_EMAIL_ADDR as PRIMARY_EMAIL_ID,EXPIRING_POLICY_EXPIRY_DATE as POLICY_EXPIRY_DATE,EXPIRING_POLICY_EXPIRY_MONTH as POLICY_EXPIRY_MONTH,PRODUCT_NAME,INTERMEDEIARY_CODE,INTERMEDIARY_NAME,RENEWAL_QUOTE_TOTAL_PREMIUM AS TOTAL_RENEWAL_PREMIUM,RENEWAL_QUOTE_STATUS,RENEWAL_NOTICE_STATUS,AUTO_RENEWAL_FLAG,SBIG_REGION as REGION,LOB,RENEWAL_QUOTE_LATEST_FLAG as RENEWAL_FLAG , SECONDARY_SALES_MANAGER_CODE as SECONDRY_SM_CODE,renewal_quote_no,loan_account_number,sbig_branch_name, asm_id as sbi_account_no FROM DE_INDIGENEOUS_RENEWAL_RPT_FY_2023_24 where EXPIRING_POLICY_EXPIRY_DATE BETWEEN :startDate and :endDate  and INTERMEDEIARY_CODE=:user and UPPER(EXPIRING_POLICY_EXPIRY_MONTH) =:formattedMonth    AND RENEWAL_POLICY_ID IS NOT NULL

mis.Motordwbiquery=select INVI_POLICY_NO,INSURED_NAME,MOBILE_NO,EMAIL_ID ,INVI_POLICY_EXPIRY_DATE,FISCALMMYYYY as POLICY_EXPIRY_MONTH,PRODUCT_NAME, INTERMEDIARY_CODE,INTERMEDIARY_NAME,REN_GWP,HEALTH_AUTO_RENEWAL,DENIED_IMD,AUTO_RENEWAL_FLAG,SBI_REGION,LOB,CASE WHEN REN_POLICY_NO IS NULL THEN 'N' ELSE 'Y' END AS RENEWAL_FLAG,SSM_NAME,RENEWAL_QUOTE_NUMBER,loan_account_no,sbig_branch, asm_id as sbi_account_no,REGISTRATION_NUMBER,YEAR_OF_MANUFACTURING,CHASSIS_NUMBER,UAT_DECLINE_MK_MODEL,MODEL_VEHICLE,NCB_AMOUNT FROM RMS_RENEWAL_DATAMART  where INVI_POLICY_EXPIRY_DATE BETWEEN :startDate and :endDate  and TO_CHAR(FISCALMONTHYEAR, 'MM-YY') =:formattedMonth  and AGREEMENT_CODE IN(:user) AND LOB ='Motor'
mis.Healthdwbiquery=select INVI_POLICY_NO,INSURED_NAME,MOBILE_NO,EMAIL_ID ,INVI_POLICY_EXPIRY_DATE,FISCALMMYYYY as POLICY_EXPIRY_MONTH,PRODUCT_NAME, INTERMEDIARY_CODE,INTERMEDIARY_NAME,REN_GWP,HEALTH_AUTO_RENEWAL,DENIED_IMD,AUTO_RENEWAL_FLAG,SBI_REGION,LOB,CASE WHEN REN_POLICY_NO IS NULL THEN 'N' ELSE 'Y' END AS RENEWAL_FLAG,SSM_NAME,RENEWAL_QUOTE_NUMBER,loan_account_no,sbig_branch, asm_id as sbi_account_no,REGISTRATION_NUMBER,YEAR_OF_MANUFACTURING,CHASSIS_NUMBER,UAT_DECLINE_MK_MODEL,MODEL_VEHICLE,NCB_AMOUNT FROM RMS_RENEWAL_DATAMART  where INVI_POLICY_EXPIRY_DATE BETWEEN :startDate and :endDate  and TO_CHAR(FISCALMONTHYEAR, 'MM-YY') =:formattedMonth    and AGREEMENT_CODE IN(:user) AND LOB ='Health'
mis.SmeproductType=select INVI_POLICY_NO,INSURED_NAME,MOBILE_NO,EMAIL_ID ,INVI_POLICY_EXPIRY_DATE,FISCALMMYYYY as POLICY_EXPIRY_MONTH,PRODUCT_NAME, INTERMEDIARY_CODE,INTERMEDIARY_NAME,REN_GWP,HEALTH_AUTO_RENEWAL,DENIED_IMD,AUTO_RENEWAL_FLAG,SBI_REGION,LOB,CASE WHEN REN_POLICY_NO IS NULL THEN 'N' ELSE 'Y' END AS RENEWAL_FLAG,SSM_NAME,RENEWAL_QUOTE_NUMBER,loan_account_no,sbig_branch, asm_id as sbi_account_no,REGISTRATION_NUMBER,YEAR_OF_MANUFACTURING,CHASSIS_NUMBER,UAT_DECLINE_MK_MODEL,MODEL_VEHICLE,NCB_AMOUNT FROM RMS_RENEWAL_DATAMART  where INVI_POLICY_EXPIRY_DATE BETWEEN :startDate and :endDate  and TO_CHAR(FISCALMONTHYEAR, 'MM-YY') =:formattedMonth  and AGREEMENT_CODE IN(:user) AND LOB not in('Health','Motor')
###############

creditLimit=select CREDIT_LIMIT,LIMIT_START_DATE,LIMIT_END_DATE from TBL_IMDLIMIT where IMD_PARENT_CODE=:parentCode and IMD_CHILD_CODE=:Childcode
ChildCardQuery=select agreement_code from TEMP_LIMIT_AGREEMENT_MASTER  where AGENT_ID=:parentCode
parentCardQuery=select parent_credit_limit,CREDIT_START_DATE,CREDIT_END_DATE,insurencename from TBL_IMD_PARENT_CODE where IMD_PARENT_CODE=:parentCode